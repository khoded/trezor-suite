suite-desktop build mac:
    variables:
        DEPLOY_DIRECTORY: ${DEPLOY_BASE_DIR}/suite-desktop/${CI_BUILD_REF_NAME}
    stage: build artifacts
    script:
        - yarn cache clean
        - yarn workspace @trezor/suite-data copy-static-files
        - yarn workspace @trezor/suite-desktop build:mac
        - mkdir -p ${DEPLOY_DIRECTORY}
        - mv $PACKAGE_PATH_SUITE_DESKTOP/build-electron/TrezorSuite-*.zip ${DEPLOY_DIRECTORY}/

suite-desktop build linux:
    stage: build artifacts
    variables:
        DEPLOY_DIRECTORY: ${DEPLOY_BASE_DIR}/suite-desktop/${CI_BUILD_REF_NAME}
    script:
        - yarn cache clean
        - yarn workspace @trezor/suite-data copy-static-files
        - yarn workspace @trezor/suite-desktop build:linux
        - mkdir -p ${DEPLOY_DIRECTORY}
        - mv $PACKAGE_PATH_SUITE_DESKTOP/build-electron/TrezorSuite-*.AppImage ${DEPLOY_DIRECTORY}/

suite-desktop build windows:
    stage: build artifacts
    variables:
        DEPLOY_DIRECTORY: ${DEPLOY_BASE_DIR}/suite-desktop/${CI_BUILD_REF_NAME}
    image: electronuserland/builder:wine
    script:
        - yarn cache clean
        - yarn workspace @trezor/suite-data copy-static-files
        - yarn workspace @trezor/suite-desktop build:win
        - mkdir -p ${DEPLOY_DIRECTORY}
        - mv $PACKAGE_PATH_SUITE_DESKTOP/build-electron/TrezorSuite-*.exe ${DEPLOY_DIRECTORY}/
