before_script: {}

install and build:
    stage: setup environment
    script:
        - yarn
        - yarn run build:libs
        - cp -r node_modules /cache/${CI_COMMIT_REF_SLUG}
        - cp -r packages/blockchain-link/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/blockchain-link/node_modules
        - cp -r packages/components/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/components/node_modules
        - cp -r packages/components-v2/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/components-v2/node_modules
        - cp -r packages/components-storybook/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/components-storybook/node_modules
        - cp -r packages/components-storybook-v2/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/components-storybook-v2/node_modules
        - cp -r packages/connect-explorer/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/connect-explorer/node_modules
        - cp -r packages/rollout/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/rollout/node_modules
        - cp -r packages/suite/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/suite/node_modules
        - cp -r packages/suite-native/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/suite-native/node_modules
        - cp -r packages/suite-storage/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/suite-storage/node_modules
        - cp -r packages/translations-manager/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/translations-manager/node_modules
        - cp -r packages/integration-tests/node_modules /cache/${CI_COMMIT_REF_SLUG}/packages/integration-tests/node_modules
    artifacts:
        expire_in: 3 hours
        when: always
        paths:
            # libs
            - packages/components/lib
            - packages/components-v2/lib
            - packages/blockchain-link/lib
            - packages/rollout/lib
            - packages/suite-storage/lib
            - packages/translations-manager/lib
